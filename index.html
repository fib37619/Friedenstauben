<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Friedenstaube & Projektmarker</title>
<style>
  body { font-family: sans-serif; text-align: center; margin:0; padding:0;}
  h1, p { margin: 10px 0; }
  #mapContainer { position: relative; display: inline-block; cursor: crosshair; }
  #worldMap { width: 90vw; max-width: 1000px; display: block; }

  .dove { position: absolute; font-size: 30px; transform: translate(-50%, -50%); }
  .wish { position: absolute; transform: translate(-50%, -150%); font-size: 14px; background: rgba(255,255,255,0.7); padding: 2px 4px; border-radius: 4px; }

  .project-marker {
    position: absolute;
    width: 20px; height: 20px;
    background: #FF6347; border-radius: 50%;
    border: 2px solid white; transform: translate(-50%, -50%);
    cursor: pointer; animation: pulse 2s infinite;
    box-shadow: 0 0 6px rgba(0,0,0,0.3);
  }
  .project-marker:hover::after {
    content: attr(data-title);
    position: absolute; top: -30px; left: 50%; transform: translateX(-50%);
    background: rgba(255,255,255,0.9); padding: 4px 8px; border-radius: 4px;
    white-space: nowrap; font-size: 12px; box-shadow: 0 0 5px rgba(0,0,0,0.2);
  }
  @keyframes pulse { 0% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.2); } 100% { transform: translate(-50%, -50%) scale(1); } }

  #adminOutput { margin-top:10px; font-family: monospace; white-space: pre-wrap; text-align:left; max-width:90vw; }
</style>
</head>
<body>

<h1>Friedenstaube & Projektmarker</h1>
<p>Klicke auf die Weltkarte, um deinen Friedenswunsch zu senden oder als Admin ein Projekt zu markieren</p>

<form id="wishForm">
  <input type="text" id="wishInput" placeholder="Dein Friedenswunsch" required>
  <button type="submit">Taube senden</button>
</form>

<div id="mapContainer">
  <img id="worldMap" 
       src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/World_map_-_low_resolution.svg/1000px-World_map_-_low_resolution.svg.png" 
       alt="Weltkarte">
</div>

<div id="adminOutput"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script>
const form = document.getElementById('wishForm');
const mapContainer = document.getElementById('mapContainer');
const worldMap = document.getElementById('worldMap');
const adminOutput = document.getElementById('adminOutput');

let targetX = null;
let targetY = null;

// Nutzermarker für Wünsche
let marker = document.createElement('div');
marker.style.position = 'absolute';
marker.style.color = 'red';
marker.style.fontSize = '20px';
marker.textContent = '✚';
marker.style.display = 'none';
mapContainer.appendChild(marker);

// Funktion: Projektmarker setzen
function addProjectMarker(x, y, name, year){
  const projDiv = document.createElement('div');
  projDiv.className = 'project-marker';
  projDiv.style.left = x + 'px';
  projDiv.style.top = y + 'px';
  projDiv.setAttribute('data-title', `${year}: ${name}`);
  mapContainer.appendChild(projDiv);
  projects.push({x, y, name, year});
}

// Admin-Code ausgeben (für GitHub)
function updateAdminOutput(){
  let code = "const projects = [\n";
  projects.forEach(p => {
    code += `  {year: ${p.year}, name: "${p.name}", x: ${p.x}, y: ${p.y}},\n`;
  });
  code += "];";
  adminOutput.textContent = code;
}

// Vordefinierte Projekte
const projects = [
  {year: 2025, name: "Casa Social Cultural y Memoria", x: 247, y: 340},
  {year: 2024, name: "Kiran Kamal Prasad / Projekt Jeevika", x: 700, y: 310},
  {year: 2023, name: "Reaching Out Romania – Rumänien", x: 543, y: 203.5},
  {year: 2022, name: "Youth Peace Ambassadors Network – international / Europarat (Europa)", x: 490, y: 188.5},
  {year: 2021, name: "Secondary School in Nyashishi / Pippi House for Girls", x: 582, y: 361.5},
  {year: 2020, name: "Dr. Massimo Del Bene ", x: 514, y: 220.5},
  {year: 2019, name: "Pfarrer József Lankó", x: 524, y: 201.5},
  {year: 2018, name: "Syrian Center for Media and Freedom of Expression / Yara Bader", x: 582, y: 241.5},
  {year: 2017, name: "Pater Shay Cullen / PREDA", x: 841, y: 305.5},
  {year: 2016, name: "Parents Circle Families Forum", x: 576, y: 254.5},
  {year: 2015, name: "Thérèse Mema Mapenzi ", x: 548, y: 358.5},
  {year: 2014, name: "Lory Obal / ICON", x: 850, y: 329.5},
  {year: 2013, name: "Padre Paulo Joanil da Silva / CPT", x: 320, y: 378.5},
  {year: 2012, name: "Bertha Cáceres Flores / COPINH ", x: 222, y: 305.5},
];

// Marker für alle vordefinierten Projekte erzeugen
projects.forEach(p => addProjectMarker(p.x, p.y, p.name, p.year));
updateAdminOutput();

// Klick auf Karte
worldMap.addEventListener('click', (e) => {
  const rect = worldMap.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;

  // Prüfen, ob Admin-Modus: Shift gedrückt → Projekt hinzufügen
  if(e.shiftKey) {
    const name = prompt("Projektname:");
    const year = prompt("Jahr:");
    if(name && year){
      addProjectMarker(x, y, name, year);
      updateAdminOutput();
    }
    return; // kein Wunsch setzen
  }

  // Normaler Nutzer klick → Ziel speichern
  targetX = x;
  targetY = y;
  marker.style.left = targetX + 'px';
  marker.style.top = targetY + 'px';
  marker.style.display = 'block';
});

// Formular abgeschickt → Taube fliegt los
form.addEventListener('submit', function(e){
  e.preventDefault();
  const wish = document.getElementById('wishInput').value;

  if(targetX === null || targetY === null) {
    alert("Bitte zuerst auf die Weltkarte klicken!");
    return;
  }

  const dove = document.createElement('div');
  dove.className = 'dove';
  dove.textContent = '🕊️';
  dove.style.left = '50%';
  dove.style.top = '90%';
  mapContainer.appendChild(dove);

  gsap.to(dove, {
    duration: 3,
    left: targetX + 'px',
    top: targetY + 'px',
    ease: "power1.inOut",
    onComplete: () => {
      const wishDiv = document.createElement('div');
      wishDiv.className = 'wish';
      wishDiv.style.left = targetX + 'px';
      wishDiv.style.top = targetY + 'px';
      wishDiv.textContent = wish;
      mapContainer.appendChild(wishDiv);
    }
  });

  form.reset();
});
</script>

</body>
</html>
