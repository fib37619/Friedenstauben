<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Friedenstaube & Projektmarker</title>
<style>
  body { font-family: sans-serif; text-align: center; margin:0; padding:0;}
  h1, p { margin: 10px 0; }
  #mapContainer { position: relative; display: inline-block; cursor: crosshair; }
  #worldMap { width: 90vw; max-width: 1000px; display: block; }

  .dove { position: absolute; font-size: 30px; transform: translate(-50%, -50%); }
  .wish { position: absolute; transform: translate(-50%, -150%); font-size: 14px; background: rgba(255,255,255,0.7); padding: 2px 4px; border-radius: 4px; }

  .project-marker {
    position: absolute;
    width: 20px; height: 20px;
    background: #FF6347; border-radius: 50%;
    border: 2px solid white; transform: translate(-50%, -50%);
    cursor: pointer; animation: pulse 2s infinite;
    box-shadow: 0 0 6px rgba(0,0,0,0.3);
  }
  .project-marker:hover::after {
    content: attr(data-title);
    position: absolute; top: -30px; left: 50%; transform: translateX(-50%);
    background: rgba(255,255,255,0.9); padding: 4px 8px; border-radius: 4px;
    white-space: nowrap; font-size: 12px; box-shadow: 0 0 5px rgba(0,0,0,0.2);
  }
  @keyframes pulse { 0% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.2); } 100% { transform: translate(-50%, -50%) scale(1); } }
</style>
</head>
<body>

<h1>Friedenstaube & Projektmarker</h1>
<p>Klicke auf die Weltkarte, um deinen Friedenswunsch zu senden oder als Admin ein Projekt zu markieren</p>

<form id="wishForm">
  <input type="text" id="wishInput" placeholder="Dein Friedenswunsch" required>
  <button type="submit">Taube senden</button>
</form>

<div id="mapContainer">
  <img id="worldMap" 
       src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/World_map_-_low_resolution.svg/1000px-World_map_-_low_resolution.svg.png" 
       alt="Weltkarte">
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script>
const form = document.getElementById('wishForm');
const mapContainer = document.getElementById('mapContainer');
const worldMap = document.getElementById('worldMap');

let targetX = null;
let targetY = null;

// Nutzermarker für Wünsche
let marker = document.createElement('div');
marker.style.position = 'absolute';
marker.style.color = 'red';
marker.style.fontSize = '20px';
marker.textContent = '✚';
marker.style.display = 'none';
mapContainer.appendChild(marker);

// Vordefinierte Projekte (Koordinaten in Prozent)
const projects = [
  {year: 2025, name: "Casa Social Cultural y Memoria", xPerc: 24.7, yPerc: 54},
  {year: 2024, name: "Kiran Kamal Prasad / Projekt Jeevika", xPerc: 70, yPerc: 48},
  {year: 2023, name: "Reaching Out Romania – Rumänien", xPerc: 54.3, yPerc: 40.35},
  {year: 2022, name: "Youth Peace Ambassadors Network – international / Europarat (Europa)", xPerc: 49, yPerc: 28.85},
  {year: 2021, name: "Secondary School in Nyashishi / Pippi House for Girls", xPerc: 58.2, yPerc: 56.15},
  {year: 2020, name: "Dr. Massimo Del Bene", xPerc: 51.4, yPerc: 32.05},
  {year: 2019, name: "Pfarrer József Lankó", xPerc: 52.4, yPerc: 30.15},
  {year: 2018, name: "Syrian Center for Media and Freedom of Expression / Yara Bader", xPerc: 58.2, yPerc: 34.15},
  {year: 2017, name: "Pater Shay Cullen / PREDA", xPerc: 84.1, yPerc: 50.55},
  {year: 2016, name: "Parents Circle Families Forum", xPerc: 57.6, yPerc: 35.45},
  {year: 2015, name: "Thérèse Mema Mapenzi", xPerc: 54.8, yPerc: 55.85},
  {year: 2014, name: "Lory Obal / ICON", xPerc: 85, yPerc: 52.95},
  {year: 2013, name: "Padre Paulo Joanil da Silva / CPT", xPerc: 32, yPerc: 57.85},
  {year: 2012, name: "Bertha Cáceres Flores / COPINH", xPerc: 22.2, yPerc: 48.55},
];

// Funktion: Marker positionieren
function createMarker(p){
  const projDiv = document.createElement('div');
  projDiv.className = 'project-marker';
  const rect = worldMap.getBoundingClientRect();
  projDiv.style.left = (p.xPerc/100 * rect.width) + 'px';
  projDiv.style.top = (p.yPerc/100 * rect.height) + 'px';
  projDiv.setAttribute('data-title', `${p.year}: ${p.name}`);
  mapContainer.appendChild(projDiv);
}

// Marker erzeugen
projects.forEach(p => createMarker(p));

// Marker-Positionen bei Resize aktualisieren
function updateMarkers(){
  const rect = worldMap.getBoundingClientRect();
  document.querySelectorAll('.project-marker').forEach((el, i) => {
    const p = projects[i];
    el.style.left = (p.xPerc/100 * rect.width) + 'px';
    el.style.top = (p.yPerc/100 * rect.height) + 'px';
  });
}
window.addEventListener('resize', updateMarkers);

// Neue Projekte via Shift-Klick
function addProjectMarker(xPerc, yPerc, name, year){
  const projDiv = document.createElement('div');
  projDiv.className = 'project-marker';
  const rect = worldMap.getBoundingClientRect();
  projDiv.style.left = (xPerc/100 * rect.width) + 'px';
  projDiv.style.top = (yPerc/100 * rect.height) + 'px';
  projDiv.setAttribute('data-title', `${year}: ${name}`);
  mapContainer.appendChild(projDiv);
  projects.push({xPerc, yPerc, name, year});
}

// Klick auf Karte
worldMap.addEventListener('click', (e) => {
  const rect = worldMap.getBoundingClientRect();
  const xPerc = (e.clientX - rect.left)/rect.width*100;
  const yPerc = (e.clientY - rect.top)/rect.height*100;

  if(e.shiftKey){
    const name = prompt("Projektname:");
    const year = prompt("Jahr:");
    if(name && year){
      addProjectMarker(xPerc, yPerc, name, year);
    }
    return;
  }

  targetX = e.clientX - rect.left;
  targetY = e.clientY - rect.top;
  marker.style.left = targetX + 'px';
  marker.style.top = targetY + 'px';
  marker.style.display = 'block';
});

// Formular abgeschickt → Taube fliegt los
form.addEventListener('submit', function(e){
  e.preventDefault();
  const wish = document.getElementById('wishInput').value;

  if(targetX === null || targetY === null) {
    alert("Bitte zuerst auf die Weltkarte klicken!");
    return;
  }

  const dove = document.createElement('div');
  dove.className = 'dove';
  dove.textContent = '🕊️';
  dove.style.left = '50%';
  dove.style.top = '90%';
  mapContainer.appendChild(dove);

  gsap.to(dove, {
    duration: 3,
    left: targetX + 'px',
    top: targetY + 'px',
    ease: "power1.inOut",
    onComplete: () => {
      const wishDiv = document.createElement('div');
      wishDiv.className = 'wish';
      wishDiv.style.left = targetX + 'px';
      wishDiv.style.top = targetY + 'px';
      wishDiv.textContent = wish;
      mapContainer.appendChild(wishDiv);
    }
  });

  form.reset();
});
</script>

</body>
</html>

